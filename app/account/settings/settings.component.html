<div class="pt-2">
    <div class="row justify-content-center">
        <div class="col-md-12">
            <h2 class="text-success" jhiTranslate="settings.title" translateValues="{username: '{{settingsAccount.firstName}}'}"
                *ngIf="settingsAccount">User settings for <b>{{settingsAccount.login}}</b></h2>

            <div class="alert alert-success" *ngIf="success" jhiTranslate="settings.messages.success">
                <strong>Settings saved!</strong>
            </div>

            <jhi-alert-error></jhi-alert-error>

            <form name="form" role="form" (ngSubmit)="save()" #settingsForm="ngForm" *ngIf="settingsAccount" novalidate>
                <div class="form-row">
                  <div class="form-group col-6">
                      <label class="form-control-label" for="firstName" jhiTranslate="settings.form.firstname">First
                          Name</label>
                      <input type="text" class="form-control" id="firstName" name="firstName"
                             placeholder="{{'settings.form.firstname.placeholder' | translate}}"
                             [(ngModel)]="settingsAccount.firstName" minlength=1 maxlength=50 #firstNameInput="ngModel"
                             required>
                      <div *ngIf="firstNameInput.dirty && firstNameInput.invalid">
                          <small class="form-text text-danger"
                                 *ngIf="firstNameInput.errors.required"
                                 jhiTranslate="settings.messages.validate.firstname.required">
                              Your first name is required.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="firstNameInput.errors.minlength"
                                 jhiTranslate="settings.messages.validate.firstname.minlength">
                              Your first name is required to be at least 1 character.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="firstNameInput.errors.maxlength"
                                 jhiTranslate="settings.messages.validate.firstname.maxlength">
                              Your first name cannot be longer than 50 characters.
                          </small>
                      </div>
                  </div>
                  <div class="form-group col-6">
                      <label class="form-control-label" for="lastName" jhiTranslate="settings.form.lastname">Last
                          Name</label>
                      <input type="text" class="form-control" id="lastName" name="lastName"
                             placeholder="{{'settings.form.lastname.placeholder' | translate}}"
                             [(ngModel)]="settingsAccount.lastName" minlength=1 maxlength=50 #lastNameInput="ngModel"
                             required>
                      <div *ngIf="lastNameInput.dirty && lastNameInput.invalid">
                          <small class="form-text text-danger"
                                 *ngIf="lastNameInput.errors.required"
                                 jhiTranslate="settings.messages.validate.lastname.required">
                              Your last name is required.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="lastNameInput.errors.minlength"
                                 jhiTranslate="settings.messages.validate.lastname.minlength">
                              Your last name is required to be at least 1 character.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="lastNameInput.errors.maxlength"
                                 jhiTranslate="settings.messages.validate.lastname.maxlength">
                              Your last name cannot be longer than 50 characters.
                          </small>
                      </div>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-6">
                      <label class="form-control-label" for="email" jhiTranslate="global.form.email">Email</label>
                      <input type="email" class="form-control" id="email" name="email"
                             placeholder="{{'global.form.email.placeholder' | translate}}"
                             [(ngModel)]="settingsAccount.email" minlength="5" maxlength="100" #emailInput="ngModel" email
                             required>
                      <div *ngIf="emailInput.dirty && emailInput.invalid">
                          <small class="form-text text-danger"
                                 *ngIf="emailInput.errors.required"
                                 jhiTranslate="global.messages.validate.email.required">
                              Your email is required.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="emailInput.errors.email" jhiTranslate="global.messages.validate.email.invalid">
                              Your email is invalid.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="emailInput.errors.minlength"
                                 jhiTranslate="global.messages.validate.email.minlength">
                              Your email is required to be at least 5 characters.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="emailInput.errors.maxlength"
                                 jhiTranslate="global.messages.validate.email.maxlength">
                              Your email cannot be longer than 100 characters.
                          </small>
                      </div>
                  </div>
                  <div class="form-group col-6">
                      <label class="form-control-label" for="phoneNumber" jhiTranslate="settings.form.phonenumber">Phone
                          number</label>
                      <input type="tel" class="form-control" id="phoneNumber" name="phoneNumber"
                             placeholder="{{'settings.form.phonenumber.placeholder' | translate}}"
                             [(ngModel)]="settingsAccount.phoneNumber" minlength="7" maxlength="20"
                             #phoneNumberInput="ngModel" pattern="[0-9extEXT ]*">
                      <div *ngIf="phoneNumberInput.dirty && phoneNumberInput.invalid">
                          <small class="form-text text-danger"
                                 *ngIf="phoneNumberInput.errors.pattern"
                                 jhiTranslate="settings.messages.validate.phonenumber.pattern">
                              You must write only numbers and if it is necessary \"ext\" to indicate the extension.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="phoneNumberInput.errors.minlength"
                                 jhiTranslate="settings.messages.validate.phonenumber.minlength">
                              Your phone number is required to be at least 7 numbers.
                          </small>
                          <small class="form-text text-danger"
                                 *ngIf="phoneNumberInput.errors.maxlength"
                                 jhiTranslate="settings.messages.validate.phonenumber.maxlength">
                              Your phone number cannot be longer than 20 numbers.
                          </small>
                      </div>
                  </div>
                </div>
                <div class="form-group">
                    <label class="form-control-label" jhiTranslate="settings.form.birthdate"
                           for="birthdate">Birthdate</label>
                    <div class="input-group">
                        <input id="birthdate" type="text" class="form-control" name="birthdate" ngbDatepicker
                               placement="top-left"
                               #birthdateDp="ngbDatepicker" [(ngModel)]="settingsAccount.birthdate" [maxDate]="maxDate"
                               [minDate]="minDate"/>
                        <span class="input-group-append">
                            <button type="button" class="btn btn-success" (click)="birthdateDp.toggle()"><i
                                class="fa fa-calendar"></i></button>
                        </span>
                    </div>
                </div>
                <div class="form-group" *ngIf="languages && languages.length > 0">
                    <label for="langKey" jhiTranslate="settings.form.language">Language</label>
                    <select class="form-control" id="langKey" name="langKey" [(ngModel)]="settingsAccount.langKey">
                        <option *ngFor="let language of languages" [value]="language">{{language |
                            findLanguageFromKey}}
                        </option>
                    </select>
                </div>
                <div [formGroup]="userForm" novalidate style="border: 0">
                    <div formArrayName="locations" novalidate style="border: 0">
                        <form *ngFor="let location of locations.controls; let i=index" [formGroupName]="i">
                            <!-- The repeated location template -->
                            <!-- address header, show remove button when more than one address available -->
                            <div>
                                <h4>{{ 'delcampoApp.location.detail.title' | translate }} #{{i + 1}}
                                <a class="fa fa-times float-right"
                                      (click)="removeLocation(i)"></a>
                                </h4>
                            </div>
                            <!--<div class="form-group">
                                <label class="form-control-label" jhiTranslate="delcampoApp.location.zone"
                                       for="field_zone">Zone</label>
                                <select class="form-control" id="field_zone" formControlName="zoneId">
                                    <option [ngValue]="null"></option>
                                    <option [ngValue]="zoneOption.id"
                                            *ngFor="let zoneOption of zones; trackBy: trackZoneById">
                                        {{zoneOption.zoneName}}
                                    </option>
                                </select>
                            </div>-->
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="delcampoApp.location.zone"
                                       for="field_zone">Zone</label>
                                <p-autoComplete formControlName="zoneId"
                                                id="field_zone"
                                                [suggestions]="zones"
                                                (completeMethod)="searchZone($event)"
                                                field="zoneName"
                                                [style]="{'width':'100%'}"
                                                [inputStyle]="{'width':'100%'}"
                                                forceSelection="true">
                                    <ng-template let-location pTemplate="item">
                                        <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                                            {{location.zoneName}} - {{location.cityCityName}}
                                        </div>
                                    </ng-template>
                                </p-autoComplete>
                                <div
                                    [hidden]="!(locations.controls[i].get('zoneId')?.dirty && locations.controls[i].get('zoneId')?.invalid)">
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('zoneId')?.errors?.required"
                                           jhiTranslate="entity.validation.required">
                                        This field is required.
                                    </small>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="delcampoApp.location.name"
                                       for="field_name"
                                       [ngbTooltip]="'delcampoApp.location.help.name' | translate">Name</label>
                                <input class="form-control" id="field_name"
                                       formControlName="name"/>
                                <div
                                    [hidden]="!(locations.controls[i].get('name')?.dirty && locations.controls[i].get('name')?.invalid)">
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('name')?.errors?.required"
                                           jhiTranslate="entity.validation.required">
                                        This field is required.
                                    </small>
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('name')?.errors?.maxlength"
                                           jhiTranslate="entity.validation.maxlength" translateValues="{ max: 20 }">
                                        This field cannot be longer than 20 characters.
                                    </small>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="delcampoApp.location.streetAddress"
                                       for="field_streetAddress"
                                       [ngbTooltip]="'delcampoApp.location.help.streetAddress' | translate">Street
                                    Address</label>
                                <input type="text" class="form-control" id="field_streetAddress"
                                       formControlName="streetAddress"/>
                                <div
                                    [hidden]="!(locations.controls[i].get('streetAddress')?.dirty && locations.controls[i].get('streetAddress')?.invalid)">
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('streetAddress')?.errors?.required"
                                           jhiTranslate="entity.validation.required">
                                        This field is required.
                                    </small>
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('streetAddress')?.errors?.minlength"
                                           jhiTranslate="entity.validation.minlength" translateValues="{ min: 6 }">
                                        This field is required to be at least 6 characters.
                                    </small>
                                    <small class="form-text text-danger"
                                           [hidden]="!locations.controls[i].get('streetAddress')?.errors?.maxlength"
                                           jhiTranslate="entity.validation.maxlength" translateValues="{ max: 200 }">
                                        This field cannot be longer than 200 characters.
                                    </small>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-control-label" jhiTranslate="delcampoApp.location.postalCode"
                                       for="field_postalCode"
                                       [ngbTooltip]="'delcampoApp.location.help.postalCode' | translate">Postal
                                    Code</label>
                                <input type="text" class="form-control" id="field_postalCode"
                                       formControlName="postalCode"/>
                            </div>
                            <!-- End of the repeated location template -->
                        </form>
                        <div class="form-group">
                            <a (click)="addLocation()">
                                <span class="fa fa-plus"></span>&nbsp;
                                <span jhiTranslate="delcampoApp.location.home.createLabel">Create new Location</span>
                            </a>
                        </div>
                        <br/>
                    </div>
                </div>
                <button type="submit" [disabled]="settingsForm.form.invalid" class="btn btn-warning"
                        jhiTranslate="settings.form.button">Save
                </button>
            </form>
        </div>
    </div>

</div>
